<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D 슈팅게임</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }

        #gameContainer {
            position: relative;
            width: 800px;
            height: 600px;
            background-color: #001122;
            border: 2px solid #00ff00;
            overflow: hidden;
        }

        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #00ff00;
            font-size: 20px;
            z-index: 100;
        }

        #instructions {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #00ff00;
            font-size: 14px;
            z-index: 100;
        }

        /* 플레이어 - 이미지 */
        .player {
            position: absolute;
            width: 40px;
            height: 40px;
            background-image: url('images/player.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            bottom: 20px;
            left: 380px;
            z-index: 10;
            transition: transform 0.2s ease;
        }

        .player.facing-left {
            transform: scaleX(-1);
        }

        /* 적 - 빨간색 사각형 */
        .enemy {
            position: absolute;
            width: 25px;
            height: 25px;
            background-color: #ff0000;
            z-index: 5;
        }

        /* 총알 - 노란색 원 */
        .bullet {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #ffff00;
            border-radius: 50%;
            z-index: 8;
        }

        /* 적 총알 - 주황색 원 */
        .enemy-bullet {
            position: absolute;
            width: 6px;
            height: 6px;
            background-color: #ff6600;
            border-radius: 50%;
            z-index: 8;
        }

        /* 폭발 효과 */
        .explosion {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #ffaa00;
            border-radius: 50%;
            z-index: 15;
            animation: explode 0.3s ease-out;
        }

        @keyframes explode {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        /* 게임 오버 화면 */
        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff0000;
            font-size: 36px;
            text-align: center;
            z-index: 100;
            display: none;
        }

        #gameOver button {
            background-color: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }

        #gameOver button:hover {
            background-color: #00cc00;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="score">점수: 0</div>
        <div id="instructions">WASD: 이동 | 스페이스: 발사</div>
        <div class="player" id="player"></div>
        <div id="gameOver">
            <div>게임 오버!</div>
            <div id="finalScore">최종 점수: 0</div>
            <button onclick="restartGame()">다시 시작</button>
        </div>
    </div>

    <script>
        const gameContainer = document.getElementById('gameContainer');
        const player = document.getElementById('player');
        const scoreElement = document.getElementById('score');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');

        let gameRunning = true;
        let score = 0;
        let playerPos = { x: 380, y: 550 };
        let bullets = [];
        let enemies = [];
        let enemyBullets = [];
        let keys = {};
        let playerFacing = 'right';

        // 키보드 이벤트
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            if (e.key === ' ') {
                e.preventDefault();
                shootBullet();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        // 총알 발사
        function shootBullet() {
            if (!gameRunning) return;
            
            const bullet = document.createElement('div');
            bullet.className = 'bullet';
            bullet.style.left = (playerPos.x + 20) + 'px';
            bullet.style.top = (playerPos.y - 10) + 'px';
            gameContainer.appendChild(bullet);
            
            bullets.push({
                element: bullet,
                x: playerPos.x + 20,
                y: playerPos.y - 10
            });
        }

        // 적 생성
        function createEnemy() {
            if (!gameRunning) return;
            
            const enemy = document.createElement('div');
            enemy.className = 'enemy';
            const x = Math.random() * (800 - 25);
            enemy.style.left = x + 'px';
            enemy.style.top = '0px';
            gameContainer.appendChild(enemy);
            
            enemies.push({
                element: enemy,
                x: x,
                y: 0,
                speed: Math.random() * 2 + 1,
                lastShot: Date.now()
            });
        }

        // 적 총알 발사
        function enemyShoot(enemy) {
            if (!gameRunning) return;
            
            const bullet = document.createElement('div');
            bullet.className = 'enemy-bullet';
            bullet.style.left = (enemy.x + 12) + 'px';
            bullet.style.top = (enemy.y + 25) + 'px';
            gameContainer.appendChild(bullet);
            
            enemyBullets.push({
                element: bullet,
                x: enemy.x + 12,
                y: enemy.y + 25
            });
        }

        // 폭발 효과
        function createExplosion(x, y) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            gameContainer.appendChild(explosion);
            
            setTimeout(() => {
                if (explosion.parentNode) {
                    explosion.parentNode.removeChild(explosion);
                }
            }, 300);
        }

        // 충돌 검사
        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        // 게임 종료
        function gameOver() {
            gameRunning = false;
            finalScoreElement.textContent = '최종 점수: ' + score;
            gameOverElement.style.display = 'block';
        }

        // 게임 재시작
        function restartGame() {
            gameRunning = true;
            score = 0;
            playerPos = { x: 380, y: 550 };
            playerFacing = 'right';
            
            // 모든 게임 요소 제거
            bullets.forEach(bullet => bullet.element.remove());
            enemies.forEach(enemy => enemy.element.remove());
            enemyBullets.forEach(bullet => bullet.element.remove());
            
            bullets = [];
            enemies = [];
            enemyBullets = [];
            
            scoreElement.textContent = '점수: 0';
            gameOverElement.style.display = 'none';
            
            player.classList.remove('facing-left');
            player.style.left = playerPos.x + 'px';
            player.style.top = playerPos.y + 'px';
        }

        // 게임 루프
        function gameLoop() {
            if (!gameRunning) return;

            // 플레이어 이동
            if (keys['a'] && playerPos.x > 0) {
                playerPos.x -= 5;
                if (playerFacing !== 'left') {
                    playerFacing = 'left';
                    player.classList.add('facing-left');
                }
            }
            if (keys['d'] && playerPos.x < 760) {
                playerPos.x += 5;
                if (playerFacing !== 'right') {
                    playerFacing = 'right';
                    player.classList.remove('facing-left');
                }
            }
            if (keys['w'] && playerPos.y > 0) {
                playerPos.y -= 5;
            }
            if (keys['s'] && playerPos.y < 560) {
                playerPos.y += 5;
            }
            
            player.style.left = playerPos.x + 'px';
            player.style.top = playerPos.y + 'px';

            // 총알 이동
            bullets.forEach((bullet, index) => {
                bullet.y -= 8;
                bullet.element.style.top = bullet.y + 'px';
                
                if (bullet.y < 0) {
                    bullet.element.remove();
                    bullets.splice(index, 1);
                }
            });

            // 적 이동 및 총알 발사
            enemies.forEach((enemy, index) => {
                enemy.y += enemy.speed;
                enemy.element.style.top = enemy.y + 'px';
                
                // 적 총알 발사 (랜덤하게)
                if (Date.now() - enemy.lastShot > 1000 + Math.random() * 2000) {
                    enemyShoot(enemy);
                    enemy.lastShot = Date.now();
                }
                
                if (enemy.y > 600) {
                    enemy.element.remove();
                    enemies.splice(index, 1);
                }
            });

            // 적 총알 이동
            enemyBullets.forEach((bullet, index) => {
                bullet.y += 4;
                bullet.element.style.top = bullet.y + 'px';
                
                if (bullet.y > 600) {
                    bullet.element.remove();
                    enemyBullets.splice(index, 1);
                }
            });

            // 충돌 검사 - 플레이어 총알과 적
            bullets.forEach((bullet, bulletIndex) => {
                enemies.forEach((enemy, enemyIndex) => {
                    if (checkCollision(
                        {x: bullet.x, y: bullet.y, width: 8, height: 8},
                        {x: enemy.x, y: enemy.y, width: 25, height: 25}
                    )) {
                        createExplosion(enemy.x, enemy.y);
                        bullet.element.remove();
                        enemy.element.remove();
                        bullets.splice(bulletIndex, 1);
                        enemies.splice(enemyIndex, 1);
                        score += 10;
                        scoreElement.textContent = '점수: ' + score;
                    }
                });
            });

            // 충돌 검사 - 적 총알과 플레이어
            enemyBullets.forEach((bullet, index) => {
                if (checkCollision(
                    {x: bullet.x, y: bullet.y, width: 6, height: 6},
                    {x: playerPos.x, y: playerPos.y, width: 40, height: 40}
                )) {
                    createExplosion(playerPos.x, playerPos.y);
                    gameOver();
                }
            });

            // 충돌 검사 - 적과 플레이어
            enemies.forEach((enemy, index) => {
                if (checkCollision(
                    {x: enemy.x, y: enemy.y, width: 25, height: 25},
                    {x: playerPos.x, y: playerPos.y, width: 40, height: 40}
                )) {
                    createExplosion(playerPos.x, playerPos.y);
                    gameOver();
                }
            });
        }

        // 적 생성 타이머
        setInterval(() => {
            if (gameRunning && Math.random() < 0.7) {
                createEnemy();
            }
        }, 1000);

        // 게임 루프 시작
        setInterval(gameLoop, 1000 / 60); // 60 FPS
    </script>
</body>
</html>